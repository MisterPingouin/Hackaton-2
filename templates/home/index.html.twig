{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('showChoice') }}
    {% if app.user %}
        <script src="https://cdn.botpress.cloud/webchat/v0/inject.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                window.botpressWebChat.init({
                    "botId": "bda36578-85a1-4fed-8f01-dc880a58e0c8",
                    "hostUrl": "https://cdn.botpress.cloud/webchat/v0",
                    "messagingUrl": "https://messaging.botpress.cloud",
                    "clientId": "bda36578-85a1-4fed-8f01-dc880a58e0c8",
                    "botName": "Emmaus Connect Bot",
                    "avatarUrl": "https://emmaus-connect.org/logo.svg",
                    "stylesheet": "https://cdn.jsdelivr.net/gh/MisterPingouin/Hackaton-2@c5c9fd88704dfcfa6ea8967232615b1d38d68a22/assets/styles/botpress.css"
                });
            });
        </script>
    {% endif %}
{% endblock %}

{% block body %}
    {% if app.user %}
        <div class="container mt-5">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    {{ form_start(form) }}

                    <div id="choice-marque">
                        {{ form_row(form.marque) }}
                    </div>

                    <div id="choice-modele" class="d-none">
                        {{ form_row(form.modele) }}
                    </div>

                    <div id="choice-ram" class="d-none">
                        {{ form_row(form.ram) }}
                    </div>

                    <div id="choice-stockage" class="d-none">
                        {{ form_row(form.stockage) }}
                    </div>

                    <div id="choice-etat" class="d-none">
                        {{ form_row(form.etat) }}
                    </div>

                    <div class="text-center">
                        <button id="choice-btn" class="d-none btn btn-primary text-white">{{ button|default('Envoyer') }}</button>
                    </div>

                    {{ form_end(form) }}
                   {% if form.vars.submitted and price is defined %}
    <p>Ce téléphone est estimé à {{ price }}€.</p>
    <p>Modèle : {{ modele.name }}</p>
    <p>Marque : {{ marque.name }}</p>
    
    {% if ficheTechnique is defined %}
        <h3>Fiche Technique</h3>
        <p>Taille de l'écran : {{ ficheTechnique.ScreenSize }}</p>
        <p>Processeur : {{ ficheTechnique.processeur }}</p>
        <p>Batterie : {{ ficheTechnique.batterie }}</p>
        <p>Photo : {{ ficheTechnique.photo }}</p>
        <p>Poids : {{ ficheTechnique.poids }}</p>
    {% endif %}
{% endif %}
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}